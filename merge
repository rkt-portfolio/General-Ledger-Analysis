/* MERGING JE DATA WITH USER NAME LIST FOR USERNAMES: */

	/*** SORTING THE JE DATA BY USER ID ***/

	PROC SORT DATA=SASDATA.JE_FINAL OUT=SASDATA.JE_FINAL2;
	BY USER_ID;
	RUN;

	/*** USER NAMES LIST ***/
	DATA SASDATA.USER_NAME_LIST                      ;
    %LET _EFIERR_ = 0; /* SET THE ERROR DETECTION MACRO VARIABLE */
    INFILE "G:\THORINDUSTRIESIN\FY13\Q1Q3\RAWDATA\THOR MOTOR COACH_USERS LIST Q1Q3 FY2013.TXT" DELIMITER='09'X MISSOVER DSD LRECL=32767 FIRSTOBS=2 ;
       INFORMAT CREATED_BY $100. ;
       INFORMAT USER_NAME $200. ;

       FORMAT CREATED_BY $100. ;
       FORMAT USER_NAME $300. ;
    INPUT
                CREATED_BY $
                USER_NAME $
    ;
    IF _ERROR_ THEN CALL SYMPUTX('_EFIERR_',1);  /* SET ERROR DETECTION MACRO VARIABLE */
    RUN;

	DATA SASDATA.USRNNME(KEEP=USER_ID USER_NAME);
	LENGTH USER_ID $100.;
	SET SASDATA.USER_NAME_LIST;
	USER_ID=UPCASE(COMPRESS(CREATED_BY));
	RUN;

	PROC SUMMARY DATA=SASDATA.USRNNME NWAY MISSING;
	CLASS USER_ID;
	ID USER_NAME;
	OUTPUT OUT=SASDATA.USNME_FIN (DROP=_TYPE_ _FREQ_);
	RUN;

	/**** MERGING JE WITH USER NAME LIST ****/
	DATA SASDATA.THOR_JE_JEDAR;
	MERGE SASDATA.JE_FINAL2(IN=A) SASDATA.USNME_FIN(IN=B);
	BY USER_ID;
	IF A;
	RUN;
